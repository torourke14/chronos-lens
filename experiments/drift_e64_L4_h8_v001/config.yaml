# if resuming, point to the previous run's checkpoint
resume_from: 'test_01/checkpoints/epoch_10.pt'
resume_optimizer: False

# --- must match checkpoint if resuming ---
model:
    embed_dim: 64
    num_heads: 2
    num_layers: 2
    ffn_dim: 256                # 4 Ã— EMBED_DIM
    max_seq_len: 128
    predictor_hidden: 128
    use_bfloat16: False

optimization:
    epochs: 50
    tau: 0.996                  # EMA momentum
    base_lr: 1e-3
    # tied to optimizer - frozen if resume_optimizer
    schedule: "linear_decay"
    # warmup_cosine req. warmup_epochs | linear_decay req. min_lr_ratio
    # warmup_epochs: 10
    min_lr_ratio: 0.1

data:
    batch_size: 64
    n_patients: 0               # max to load (0 = all)
    pad_idx: 0                  # token index reserved for padding

artifacts:
    log_emb_vecs: True          # enable/disable embedding vector extraction (default: True)
    checkpoint_every: 25        # (0: once at end)
    log_emb_vecs_every: 0       # (0: once at end)

meta:
    tag: "drift_e64_L4_h8"
    description: "First run with full cohort"