# unique tag (artifacts folder created under artifacts/runs)
tag: "jepa-128-6-8"
data:
    batch_size: 64
    n_patients: 0               # max to load (0 = all)
    pad_idx: 0                  # token index reserved for padding
    use_bfloat16: False
model:
    embed_dim: 128
    num_heads: 6
    num_layers: 8
    ffn_dim: 512                # 4 Ã— EMBED_DIM
    max_seq_len: 128
    predictor_hidden: 128
optimization:
    epochs: 100
    tau: 0.996                  # EMA momentum
    base_lr: 1e-3
    # warmup_cosine req. warmup_epochs | linear_decay req. min_lr_ratio
    schedule: "warmup_cosine"
    warmup_epochs: 10
    # min_lr_ratio: 0.1
artifacts:
    # if provided, loads from checkpoint
    # checkpoint: 'model_checkpoint.pt'   
    log_emb_vecs: True          # enable/disable embedding vec extraction (default: True)
    checkpoint_every: 25        # (0: once at end)
    log_emb_vecs_every: 20      # (0: once at end)