# unique tag (artifacts folder created under artifacts/runs)
tag: "jepa-64-2-2"
data:
    batch_size: 64
    n_patients: 0               # max to load (0 = all)
    pad_idx: 0                  # token index reserved for padding
    use_bfloat16: False
model:
    embed_dim: 64
    num_heads: 2
    num_layers: 2
    ffn_dim: 256                # 4 Ã— EMBED_DIM
    max_seq_len: 128
    predictor_hidden: 128
optimization:
    epochs: 50
    tau: 0.996                  # EMA momentum
    base_lr: 1e-3
    # warmup_cosine req. warmup_epochs | linear_decay req. min_lr_ratio
    schedule: "linear_decay"
    # warmup_epochs: 10
    min_lr_ratio: 0.1
artifacts:
             # unique tag (artifacts folder created under artifacts/runs)
    # if provided, loads from checkpoint
    # checkpoint: 'model_checkpoint.pt'   
    log_emb_vecs: True          # enable/disable embedding vec extraction (default: True)
    checkpoint_every: 25        # (0: once at end)
    log_emb_vecs_every: 0      # (0: once at end)